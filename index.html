<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>YouTube Music Player</title>

<style>
    html, body {
  margin: 0;
  padding: 0;
}
body {
  font-family: Arial, sans-serif;
}
.player-box { max-width: 720px; /* PCì—ì„œ ì ë‹¹íˆ í¼ */ width: 100%; margin: 1px auto; } 

.player-ratio {
  position: relative;
  width: 100%;
  padding-top: 56.25%;
  background: #000;
}
#player {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
table { max-width: 720px; width: 100%; margin: 10px auto; 
  margin: 10px auto;
  border-collapse: collapse;
}
td {
  padding: 10px;
  border-bottom: 1px solid #ccc;
  cursor: pointer;
}
tr.active td {
  background: #eee;
  border-left: 5px solid #0dda95;
}

/* ì»¨íŠ¸ë¡¤ ë°” ìŠ¤íƒ€ì¼ ì¶”ê°€ */
.controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin: 12px auto;
  width: min(360px, 90vw);
}
.controls button {
  padding: 8px 14px;
  font-size: 14px;
  cursor: pointer;
  border: 1px solid #bbb;
  background: #fff;
  border-radius: 6px;
}
.controls button:focus {
  outline: 2px solid #0dda95;
}
</style>
</head>

<body>

<div class="player-box">
  <div class="player-ratio">
    <div id="player"></div>
  </div>
</div>

<!-- ì¬ìƒëª©ë¡ í…Œì´ë¸” -->
<table id="playlist"></table>

<!-- ì»¨íŠ¸ë¡¤ ë°”: Prev, Play/Pause, Next -->
<div class="controls" aria-label="ì¬ìƒ ì»¨íŠ¸ë¡¤">
  <button id="btnPrev" title="ì´ì „ íŠ¸ë™">â® </button>
  <button id="btnPlayPause" title="ì¬ìƒ/ì¼ì‹œì •ì§€">â–¶ ì¬ìƒ</button>
  <button id="btnNext" title="ë‹¤ìŒ íŠ¸ë™"> â­</button>
</div>

<script>
/* â–¶ï¸ URLì—ì„œ list ê°’ ì½ê¸° */
function getPlaylistName() {
  const params = new URLSearchParams(window.location.search);
  return params.get('list') || 'old';
}

/* â–¶ï¸ ê³¡ ëª©ë¡ ì •ì˜ */
const playlists = {
  old: [
    { title: "ğŸµ ë‚œ ì •ë§ ëª°ëì—ˆë„¤", id: "_Bi1x8uPBJs" },
    { title: "ğŸµ ëŒì•„ê°€ëŠ” ì‚¼ê°ì§€", id: "-XKJVwg3XXg" }
  ],
  enka: [
    { title: "ğŸµ ë¦°(ãƒªãƒ³) - ì¸ìƒì™¸ê¸¸(äººç”Ÿä¸€è·¯)", id: "rfjffhNxdLQ" },
    { title: "ğŸµ éƒ½ã¯ã‚‹ã¿ã€€è£ç”ºã”ã“ã‚", id: "vnHDs5DlAG0" },
    { title: "ğŸµ ë¦°Xì•„ì¦ˆë§ˆ ì•„í‚¤-ì‚¬ì‚¬ë©” ìœ í‚¤(ç´°é›ª)", id: "vgPvhr7ZWbw" },
    { title: "ğŸµ ã€Œé›ªä¸­èŠ±ã€ä¼ä»£å¤å­", id: "B6WmSUodgRQ" }
  ],
  jazz: [
    { title: "ğŸ· ë²ˆì§€ì—†ëŠ” ì£¼ë§‰", id: "Z9vzsUxvsEg" },
    { title: "ğŸ· ê³ í–¥ì•„ì¤Œë§ˆ", id: "6wvUMP1ZS7U" }
  ]
};

let playlist = [];
let currentIndex = 0;

/* â–¶ï¸ ëª©ë¡ ìƒì„± ë° ì•ˆì • ë¡œë“œ */
const listName = getPlaylistName();
const currentList = (playlists[listName] && Array.isArray(playlists[listName]))
  ? playlists[listName]
  : playlists.old;

const table = document.getElementById('playlist');
playlist = currentList.map(s => s.id);

if (playlist.length > 0) {
  currentList.forEach((song, index) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${song.title}</td>`;
    tr.addEventListener('click', () => playByIndex(index));
    table.appendChild(tr);
  });
  setActiveRow(0);
}

/* â–¶ï¸ YouTube API */
var player;

function onYouTubeIframeAPIReady() {
  if (!playlist || playlist.length === 0) return;

  player = new YT.Player('player', {
    videoId: playlist[0],
    playerVars: { playsinline: 1, rel: 0 },
    events: { onStateChange }
  });
  updatePlayPauseButton();
  // ì´ˆê¸° ìƒíƒœ í‘œì‹œ
  setActiveRow(0);
}

/* ì¬ìƒ/ì¼ì‹œì •ì§€ í† ê¸€ */
function togglePlayPause() {
  if (!player) return;
  const state = player.getPlayerState();
  if (state === YT.PlayerState.PLAYING) {
    player.pauseVideo();
  } else {
    // UNSTARTED/PAUSED/ENDEDì¸ ê²½ìš° ì¬ìƒ ì‹œë„
    player.playVideo();
  }
  // ìƒíƒœ ë°˜ì˜ ì§€ì—° ë°˜ì˜
  setTimeout(updatePlayPauseButton, 100);
}

/* ì´ì „/ë‹¤ìŒ íŠ¸ë™ ì œì–´ */
function playPrev() {
  if (!playlist.length) return;
  currentIndex = (currentIndex - 1 + playlist.length) % playlist.length;
  playByIndex(currentIndex);
}
function playNext() {
  if (!playlist.length) return;
  currentIndex = (currentIndex + 1) % playlist.length;
  playByIndex(currentIndex);
}

function playByIndex(index) {
  if (!playlist[index] || !player) return;
  currentIndex = index;
  player.loadVideoById(playlist[currentIndex]);
  setActiveRow(index);
  updatePlayPauseButton();
}

/* ìƒíƒœ ë³€í™” ì²˜ë¦¬ */
function onStateChange(e) {
  // PLAYING/PAUSED/ENDEDì— ë”°ë¼ ë²„íŠ¼ ë¼ë²¨ ì—…ë°ì´íŠ¸
  updatePlayPauseButton();

  // ì—”ë”© ì‹œ ë‹¤ìŒ íŠ¸ë™ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” ë¡œì§ ìœ ì§€
  if (e.data === YT.PlayerState.ENDED) {
    currentIndex = (currentIndex + 1) % playlist.length;
    playByIndex(currentIndex);
  }
}

function setActiveRow(index) {
  document.querySelectorAll('#playlist tr').forEach((tr, i) => {
    tr.classList.toggle('active', i === index);
  });
}

/* Play/Pause ë²„íŠ¼ ë¼ë²¨ ê°±ì‹  ë¡œì§ */
function updatePlayPauseButton() {
  const btn = document.getElementById('btnPlayPause');
  if (!btn) return;
  if (!player) {
    btn.textContent = 'â–¶ ì¬ìƒ';
    btn.setAttribute('disabled', 'true');
    return;
  }
  const state = player.getPlayerState();
  if (state === YT.PlayerState.PLAYING) {
    btn.textContent = 'â¸ ì¼ì‹œì •ì§€';
  } else {
    btn.textContent = 'â–¶ ì¬ìƒ';
  }
  btn.removeAttribute('disabled');
}

/* ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²° */
document.getElementById('btnPrev').addEventListener('click', playPrev);
document.getElementById('btnNext').addEventListener('click', playNext);
document.getElementById('btnPlayPause').addEventListener('click', togglePlayPause);

</script>

<script src="https://www.youtube.com/iframe_api"></script>

</body>
</html>